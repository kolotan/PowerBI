Data Wrangling is the process of converting raw data into a useable form.

Below are the actions done on the data set.
1) Files (in PowerQuery editor)
  1.1) Customer
      1.1.1) Change [CustID] datatype as {Text}

  1.2) Data_2020  (to combine with other Years data and rename as "Data"
      1.2.1) use first row as header
      1.2.2) Append query from Otheryears table
      1.2.3) For 2020 data, having [Year] column as null, replace null with '2020'.
      1.2.4) Move [Year] next to [Month] column
      1.2.5) Merge [Day, [Month] & [Year] as [Date] column
      1.2.6) Change [Date] datatype as {Date}
      1.2.7) Split [AOCode] column using Split Column.
      1.2.8) Remove [AOCode.1] column
      1.2.9) Rename [AOCode.2] as [AOCode]
      1.2.10) Change [AOCode] datatype as {Text}
      1.2.11) Add a conditional column[ActualFlag_num] to apply on [ActualFlag]
              if [ActualFlag] value is True, set as 1, else as 0
      1.2.11) Add a conditional column[BudgetFlag_num] to apply on [BudgetFlag]
              if [BudgetFlag] value is True, set as 1, else as 0
 
      1.2.12) remove [ActualFlag] & [BudgetFlag].
      1.2.13) rename [ActualFlag_num] & [BudgetFlag_num] as [ActualFlag] & [BudgetFlag].
      1.2.14) change [ActualFlag] & [BudgetFlag] datatype as {Whole Number}
      1.2.15) Merge columns [PLCat] & [FinLevel0] as [FinID]
      1.2.16) change [AOCode], [CustID], [FinID] datatype as {Text}

  1.3) Dept       (to rename as "Department")
      1.3.1) Remove last 8 rows having null values
      1.3.2) Tranpose table
      1.3.3) use first row as header
      1.3.4) Change [AOCode] datatype as {Text}

  1.4) FinLevel   
      1.4.1) Merge columns [PL Category] & [Fin Level 0] as [FinID]

  1.5) OtherYears  
      1.5.1) import from folder
      1.5.2) remove autogenerated [Source.Name] column
      1.5.2) On query panel, right click 'OtherYears', uncheck "Enable load" to disable loading onto PowerBI 


2) PowerBI Desktop
  2.1) Create new PowerBI table date using this formula
       "Date = Calendar(DATE(2017,1,1),Date(2020,12,31))"

  2.2) Data Modelling
	2.1.1) create the following relationship 
              i) Data[AOCode] - Department[AOCode]
             ii) Data[CustID] - Customers[CustID]
            iii) Data[Date]   - Date[Date]
             iv) Data[FinID]  - FinLevel[FinID]
3) PowerBI table
  3.1) On Data Table,
     3.1.1) create new column [Actuals] using formula
             Actuals = Data[Balance]*Data[ActualFlag] 
     3.1.2) create new column [Budget] using formula
            Budget = Data[Balance]*Data[BudgetFlag] 
     3.1.3) create new measure [Revenue] using formula
            Revenue = CALCULATE(SUM(Data[Actuals]), FinLevel[FinLevelDesc]="Revenue")
     3.1.4) create new measure [Expenses] using formula
            Expenses = CALCULATE(SUM(Data[Actuals]), FinLevel[FinLevelDesc]="Expenses")
     3.1.5) create new measure [PYActual] using formula
            PYActual = CALCULATE(SUM(Data[Actuals]), SAMEPERIODLASTYEAR('Date'[Date]))
     3.1.6) create new measure [PYBal] using formula
            PYBal = CALCULATE(sum(Data[Balance]),SAMEPERIODLASTYEAR('Date'[Date]))
     3.1.7) create new measure [%Growth] using formula
            %Growth = DIVIDE(SUM(Data[Balance])-[PYBal], [PYBal],0)
 